<mat-toolbar class="top-banner">
</mat-toolbar>
<mat-card>
    <mat-card-header>
        <img mat-card-avatar src="{{avatarUrl}}" >
        <span><h3>Your Profile</h3></span>
      </mat-card-header>
    <mat-horizontal-stepper [linear]="true" #stepper>
      <mat-step [stepControl]="basicInfoGroup">
          <form [formGroup]="basicInfoGroup">

        <ng-template matStepLabel>Basic Info</ng-template>
         <mat-form-field class="field-full-width" >
        <input matInput placeholder="First Name" formControlName="fname" #fname required>
        <mat-error>Required</mat-error>
      </mat-form-field>
      <mat-form-field class="field-full-width" >
        <input matInput placeholder="Last Name" formControlName="lname" #lname required>
        <mat-error>Required</mat-error>
      </mat-form-field>
      <mat-form-field  floatLabel="always" class="mat-form-field--no-underline">
        <mat-radio-group formControlName="gender">
          <input matInput placeholder="Gender"  style="display: none" required>
          <mat-radio-button value="M" >Male&nbsp;&nbsp;</mat-radio-button>
          <mat-radio-button  value="F" >Female</mat-radio-button>
        </mat-radio-group>
        <mat-error>Required</mat-error>
      </mat-form-field>
      <mat-form-field class="field-full-width" >
          <input matInput placeholder="Email"  required formControlName="email" #email>
          <mat-error>{{getErrorMessage()}}</mat-error>
        </mat-form-field>
      <mat-form-field class="field-full-width" >
        <mat-select placeholder="When were you born?" [(value)]="birthyearSelected" formControlName="birthyear" #birthyear required>
      <mat-option *ngFor="let year of birthyearChoices" [value]="year">
        {{year}}
      </mat-option>
      <mat-error>Required</mat-error>
  </mat-select>
      </mat-form-field>
      <mat-form-field class="field-full-width">
          <input type="text" matInput placeholder="Where are you from?" [(ngModel)]="originSelected" [formControl]="origin" formControlName="origin" [matAutocomplete]="auto" required>
          <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" >
            <mat-option (onSelectionChange)="setOrigin($event, origin.value)" *ngFor="let option of filteredCountries | async" [value]="option">
              {{ option }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
      <mat-form-field class="field-full-width" >
        <input matInput placeholder="Postcode" formControlName="postcode" #postcode required>
        <mat-error>Required</mat-error>
    </mat-form-field>

          <div>
              <app-map [postcode]="postcode.value" (latLng)="setLatLng($event)" ></app-map>
            <button style="float:right;" mat-button matStepperNext>Next</button>
          </div>
        </form>
      </mat-step>
      <mat-step [stepControl]="opinionGroup">
        <form [formGroup]="opinionGroup">
          <ng-template matStepLabel>Your opinions</ng-template>
          <mat-form-field class="field-full-width" required>
            <mat-select placeholder="Status" [(value)]="psystatusSelected" formControlName="psystatus" #psystatus>
              <mat-option value="lifestyle">Is My Lifestyle</mat-option>
              <mat-option value="religion">Is My Religion</mat-option>
              <mat-option value="music">Is Just Music</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field class="field-full-width" >
            <textarea matInput placeholder="Reason" formControlName="reason" #reason></textarea>
          </mat-form-field>

          <div>
            <button mat-button matStepperPrevious>Back</button>
            <button type="submit" mat-raised-button color="primary"
            (click)="registerUser(fname.value, lname.value, gender.value, email.value, birthyear.value, origin.value, postcode.value, psystatus.value, reason.value)"
            [disabled]="(basicInfoGroup.pristine && opinionGroup.pristine) || (basicInfoGroup.invalid || opinionGroup.invalid)">Update</button>

          </div>
        </form>
      </mat-step>

    </mat-horizontal-stepper>
</mat-card>
